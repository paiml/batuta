[package]
name = "batuta"
version = "0.1.1"
edition = "2021"
authors = ["Pragmatic AI Labs"]
license = "MIT"
description = "Orchestration framework for converting ANY project (Python, C/C++, Shell) to modern Rust"
repository = "https://github.com/paiml/Batuta"
keywords = ["transpiler", "rust", "python", "c", "ml"]
categories = ["command-line-utilities", "development-tools"]
readme = "README.md"
exclude = [
    "book/",
    "docs/specifications/",
    ".github/",
    "*.md.bak",
]

[dependencies]
# Core dependencies (WASM-compatible)
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
anyhow = "1.0"
thiserror = "2.0"
chrono = { version = "0.4", features = ["serde"] }
async-trait = "0.1"
regex-lite = "0.1"

# CLI and configuration (native-only)
clap = { version = "4.5", features = ["derive", "env"], optional = true }
serde_yaml = { version = "0.9", optional = true }
toml = { version = "0.9", optional = true }

# Async runtime (different for WASM vs native)
tokio = { version = "1.48", features = ["full"], optional = true }

# Logging and tracing (native-only)
tracing = { version = "0.1", optional = true }
tracing-subscriber = { version = "0.3", features = ["env-filter"], optional = true }

# File system and paths (native-only)
walkdir = { version = "2.5", optional = true }
glob = { version = "0.3", optional = true }

# Process execution (native-only)
which = { version = "6.0", optional = true }

# Syscall tracing (native-only)
renacer = { version = "0.6.5", optional = true }

# High-performance compute (SIMD/GPU, native-only)
trueno = { version = "0.7.3", features = ["gpu"], optional = true }

# Graph database for Oracle Mode knowledge graph (native-only)
trueno-graph = { version = "0.1.1", optional = true }

# Vector database for similarity search (native-only)
trueno-db = { version = "0.3.3", optional = true }

# Utilities (native-only)
colored = { version = "3.0", optional = true }
indicatif = { version = "0.17", optional = true }

# Stack orchestration dependencies (native-only)
cargo_metadata = { version = "0.19", optional = true }
petgraph = { version = "0.7", optional = true }
semver = { version = "1.0", features = ["serde"], optional = true }
reqwest = { version = "0.12", features = ["json", "rustls-tls"], default-features = false, optional = true }
dialoguer = { version = "0.11", optional = true }

# WASM-specific dependencies
wasm-bindgen = { version = "0.2", optional = true }
wasm-bindgen-futures = { version = "0.4", optional = true }
js-sys = { version = "0.3", optional = true }
web-sys = { version = "0.3", features = ["console"], optional = true }

[features]
default = ["native"]

# Native build with all features
native = [
    "clap",
    "serde_yaml",
    "toml",
    "tokio",
    "tracing",
    "tracing-subscriber",
    "walkdir",
    "glob",
    "which",
    "renacer",
    "colored",
    "indicatif",
    "cargo_metadata",
    "petgraph",
    "semver",
    "reqwest",
    "dialoguer",
]

# WASM build with limited features
wasm = [
    "wasm-bindgen",
    "wasm-bindgen-futures",
    "js-sys",
    "web-sys",
]

# Optional feature for Trueno integration (native only)
trueno-integration = ["trueno", "native"]

# Oracle Mode with full knowledge graph support
oracle-mode = ["trueno-graph", "trueno-db", "native"]

[dev-dependencies]
assert_cmd = "2.0"
predicates = "3.1"
tempfile = "3.23"
criterion = { version = "0.5", features = ["html_reports"] }
proptest = "1.5"

[[bench]]
name = "backend_selection"
harness = false

[[bench]]
name = "converter_performance"
harness = false

[profile.release]
opt-level = 3
lto = true
codegen-units = 1
strip = true

[profile.bench]
opt-level = 3
lto = true
codegen-units = 1
